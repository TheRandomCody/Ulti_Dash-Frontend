<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Authenticating...</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
    </style>
</head>
<body>
    <p>Please wait while we log you in...</p>
    <script>
        // This page receives the access token from the backend,
        // stores it in localStorage, and then redirects the user.
        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const accessToken = urlParams.get('accessToken');
            const destination = urlParams.get('destination');

            if (accessToken && destination) {
                // Store the token so the user stays logged in
                localStorage.setItem('discord_access_token', accessToken);
                
                // Redirect to the final destination page
                window.location.href = `https://www.ulti-bot.com${decodeURIComponent(destination)}`;
            } else {
                // If something went wrong, send back to the home page
                document.body.innerText = 'Authentication failed. Redirecting...';
                setTimeout(() => {
                    window.location.href = 'https://www.ulti-bot.com/';
                }, 2000);
            }
        };
    </script>
</body>
</html>
